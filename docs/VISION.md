# LIVECITY: Фундаментальная Концепция (Final Vision)

## 1. Глобальная Цель Проекта (The North Star)

Наша цель — **уничтожить «Информационную Слепоту» в городе.**

Сегодня между *реальным качеством* заведения и его *цифровым рейтингом* (в Google/2GIS) лежит огромная пропасть. Рейтинги накручены, отзывы устарели, фото отфотошоплены. Люди выбирают «вслепую» и разочаровываются. Бизнес теряет клиентов и не понимает почему.

**LiveCity создает «Фильтр Правды»:**
Мы строим платформу, где репутация места зависит не от купленных звезд, а от **пульса реальной жизни** прямо сейчас. Мы создаем цифровой слой города, который дышит в унисон с реальным миром, и даем бизнесу пульт управления этим дыханием.

**Миссия:** Сделать выбор места для досуга гарантированно качественным для человека и прозрачным для бизнеса.

---

## 2. Возможности для ПОЛЬЗОВАТЕЛЯ (B2C)

*Роль: Турист, Житель, Семьянин.*

Пользователь получает **«Суперсилу видеть сквозь стены»**. Он знает, что происходит внутри заведения, еще не войдя в него.

### 2.1. Гарантия «Живого» Качества (Anti-Fraud) — РЕАЛИЗОВАНО

* **Проблема:** 5 звезд в Google, но по факту — грязно и невкусно.
* **Возможность:** Пользователь видит **Live Score**. Это рейтинг, который невозможно накрутить ботами.
  * Если место «мертвое» в соцсетях (нет сторис живых людей) — рейтинг падает.
  * Если место «хайпует» прямо сейчас — оно горит на карте ярким цветом.
* *Результат:* Исключение разочарований. Выбор только тех мест, которые *сейчас* на пике формы.
* **Реализация:**
  * `SocialSignalService.calculateLiveScore()` — формула: base×0.4 + activity×0.3 + sentiment×0.2 + time×0.1
  * Источники данных: 2GIS отзывы (собственный парсер), Instagram упоминания (Apify)
  * AI-анализ сентимента через Gemini 2.0 Flash
  * Автообновление: cron `sync-pulse` каждые 6-12 часов, `refresh-scores` каждые 15 минут

### 2.2. Поиск по Смыслу, а не по Словам (Semantic AI) — РЕАЛИЗОВАНО

* **Проблема:** Поиск «ресторан» выдает 1000 точек. Найти «где тихо поработать» или «где безопасно для детей» — невозможно без чтения 100 отзывов.
* **Возможность:** Пользователь пишет запрос естественным языком: *«Хочу сочный шашлык, но чтобы было тихо, зелено и дети могли побегать»*.
* **Технология:** ИИ анализирует векторы смыслов и находит места, которые подходят под *контекст*, а не просто под категорию «Еда».
* **Реализация:**
  * `POST /api/search` — трёхступенчатый поиск:
    1. **AI Semantic Search** — Gemini ранжирует заведения по релевантности к запросу
    2. **Keyword Fallback** — текстовый поиск при ошибке AI
    3. **Lazy Discovery** — если ничего не найдено → запрос в OpenStreetMap Overpass → автосоздание заведений в БД
  * Lazy Discovery — уникальная фича: система *растёт* от каждого поиска пользователя

### 2.3. Умная Логистика Дня (AI Planner) — РЕАЛИЗОВАНО

* **Проблема:** Сложно спланировать день с семьей (магазин -> поездка -> отдых).
* **Возможность:** Приложение берет на себя роль личного ассистента.
  * Оно строит таймлайн.
  * Подсказывает логистику (заезд в магазин по пути).
  * Учитывает состав группы (беременность, дети, питомцы).
* **Реализация:**
  * `POST /api/planner` + `PlannerService.planDay()`
  * Страница `/planner` — ввод запроса + preferences (groupType, budget)
  * Gemini строит оптимизированный маршрут (3-6 заведений) с таймлайном, бюджетом, логистикой

### 2.4. Решение проблемы «Куда пойти?» (Zero-Click Discovery) — РЕАЛИЗОВАНО

* **Проблема:** «Не знаю, чего хочу».
* **Возможность:** При открытии приложения пользователь видит **Тепловую Карту Спроса**. Он сразу видит, в каком районе сейчас концентрируется жизнь (тусовка, ужин, прогулки). Ему не нужно вводить запрос, город сам подсказывает направление.
* **Реализация:**
  * `GET /api/heatmap` — агрегация Live Score по географическим grid buckets
  * `HeatmapLayer` — нативный Mapbox heatmap layer + toggle в MapControls
  * `CitySelector` — выбор из 5 городов КЗ (Алматы, Астана, Шымкент, Караганда, Жезказган)

---

## 3. Возможности для БИЗНЕСА (B2B)

*Роль: Владелец ресторана, зоны отдыха, кофейни.*

Бизнес получает **«Зеркало правды» и «Инструмент влияния»**. Мы превращаем хаос отзывов в понятный план действий по увеличению прибыли.

### 3.1. Управление Репутацией (AI-Consulting) — РЕАЛИЗОВАНО

* **Проблема:** Выручка падает, владелец не знает причин. Читать 1000 сторис в Instagram невозможно.
* **Возможность:** Владелец получает **SaaS-аналитику**.
  * **Срез проблем:** ИИ группирует жалобы. *"80% негатива на этой неделе связано с долгим ожиданием счета"*.
  * **Action Plan:** Каждую неделю ИИ выдает 3 конкретных шага: *"Наймите еще одного раннера или внедрите QR-оплату, чтобы поднять рейтинг на 0.5"*.
* **Реализация:**
  * `/dashboard` — полный бизнес-дашборд:
    * Score History (30 дней, Recharts LineChart)
    * AI-группировка жалоб (ComplaintsList) + тренды (rising/stable/declining)
    * AI Action Plan (3 рекомендации с priority, impact, difficulty)
    * District Comparison (venue vs район vs город)
    * Social Pulse (mentions/week, sentiment, trend, breakdown по источникам)
    * AI Analysis (strong/weak points)

### 3.2. Конкурентная Разведка (Spyglass) — РЕАЛИЗОВАНО

* **Проблема:** Соседнее кафе полное, а у меня пусто. Почему?
* **Возможность:** Система показывает анонимизированные данные конкурентов. *"У конкурентов в радиусе 500м хвалят летнюю террасу, а у вас жалуются на духоту. Поставьте туманообразователи"*.
* **Реализация:**
  * `GET /api/dashboard/:venueId/competitors` + `CompetitorService`
  * Поиск конкурентов: та же категория, радиус 2 км
  * Gemini AI генерирует strengths/weaknesses/opportunities на основе сравнения отзывов
  * `CompetitorInsights` — компонент в дашборде (full-width)

### 3.3. Прямые Продажи (Direct Connect) — РЕАЛИЗОВАНО

* **Проблема:** Агрегаторы (Booking, Chocofood и др.) забирают 15-30% комиссии и скрывают данные клиента.
* **Возможность:** Мы убираем посредника.
  * **Кнопка WhatsApp:** Клиент пишет напрямую владельцу.
  * **Своя CRM (в Pro):** Владелец получает заявки пуш-уведомлениями ("Хочу стол на 4-х").
* *Результат:* Бизнес не платит комиссию с чека. Он платит только фиксированную подписку за софт.
* **Реализация:**
  * `wa.me/{phone}?text={encoded}` в VenueDetails
  * Контактные данные из 2GIS парсера: phone, email, website, whatsapp, Instagram

### 3.4. Возврат Контроля (The Hook) — РЕАЛИЗОВАНО

* **Возможность:** Стратегия «Троянский конь». Даже если бизнес ничего не понимает в IT, мы сами приходим к нему с инсайтом: *"Вы теряете гостей. Вот почему. Попробуйте исправить бесплатно (7 дней)"*. Это легкий вход в цифровизацию для малого бизнеса.
* **Реализация:**
  * `GET /api/insights/:venueId` — публичный эндпоинт (без auth)
  * `InsightService.generateFreeInsight()` — Gemini генерирует: hook (проблема), problems, quick wins, estimated revenue loss
  * `/insights` — каталог всех заведений со Score
  * `/insights/[venueId]` — страница с бесплатным инсайтом + CTA «Попробовать полный дашборд бесплатно (7 дней)»

---

## 4. Реализованные фичи за пределами исходного Vision

Эти возможности появились в процессе разработки и усиливают платформу:

### 4.1. Lazy Discovery (Саморастущая БД)

Если пользователь ищет заведение, которого нет в БД → система автоматически ищет его в OpenStreetMap Overpass → создаёт в БД с начальным score → показывает пользователю. БД растёт от каждого запроса.

### 4.2. City Radar (Автоматическое обнаружение)

Cron-задача `venue-scout` еженедельно сканирует OpenStreetMap для 5 городов КЗ (Алматы, Астана, Шымкент, Караганда, Жезказган) и автоматически добавляет новые заведения.

### 4.3. Собственный 2GIS Parser

Бесплатный парсер 2GIS каталога (без API-ключа). Извлекает: адрес, телефон, email, сайт, соцсети, часы работы, фото, рубрики, отзывы. Заменяет платный Apify.

### 4.4. 3-Mode Sync Pipeline

Главный cron `sync-pulse` работает в трёх режимах:
- **Mode A:** Apify 2GIS Reviews (legacy, платный)
- **Mode B:** Собственный 2GIS парсер (бесплатный, default)
- **Mode C:** OSM-only fallback (без внешних API)

Режим определяется автоматически по наличию env-переменных.

---

## 5. Далекое Будущее (Backlog / Possible Expansion)

*Эти функции мы держим в уме как потенциал для роста капитализации.*

1. **Авторизация и аккаунты** — NextAuth + владение заведением + роли (user/business/admin)
2. **Платная подписка** — тарифные планы для бизнес-клиентов (Free/Pro/Enterprise)
3. **Офлайн-режим (Offline Mode):** Потребует сложной синхронизации баз данных. Актуально при глобальной экспансии.
4. **Партнерская сеть (Affiliate CPA):** Интеграция с такси, авиабилетами и отелями. Вводится при критической массе (100k+ MAU).
5. **Мобильное приложение** — React Native или PWA
6. **Real-time уведомления** — WebSocket для обновления Live Score в реальном времени

---

## Резюме для команды (Summary)

* **Мы строим:** Технологический мост доверия.
* **Мы продаем:** Пользователям — уверенность в качестве досуга. Бизнесу — инсайты для роста прибыли.
* **Наш враг:** Фейковые отзывы и устаревшие данные.
* **Наше оружие:** Google Gemini AI + Реальные социальные сигналы (2GIS + Instagram) + OpenStreetMap.
* **Статус реализации:** Все 4 B2C-фичи и все 4 B2B-фичи из Vision реализованы + 4 дополнительные фичи сверх плана.
